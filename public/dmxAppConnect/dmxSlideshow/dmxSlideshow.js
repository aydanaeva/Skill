/*!
 DMXzone Slideshow
 Version: 1.0.7
 (c) 2020 DMXzone.com
 @build 2020-02-27 17:22:51
 */
dmx.slideshow={},dmx.slideshow.transitions={},dmx.slideshow.Transition=function(t,e){this.slideshow=t,this.options=Object.assign({requires3d:!1,setup:dmx.noop,createTile:dmx.noop,execute:this.finished.bind(this),after:dmx.noop},e)},dmx.slideshow.Transition.prototype={constructor:dmx.slideshow.Transition,hasFinished:!1,run:function(t){this.index=t,this.prevSlide=this.slideshow.slides[this.slideshow.data.index],this.nextSlide=this.slideshow.slides[t],this.width=this.slideshow.slidesContainer.offsetWidth,this.height=this.slideshow.slidesContainer.offsetHeight,this.options.setup.call(this),this.slideshow.$node.offsetWidth,requestAnimationFrame(this.options.execute.bind(this))},finished:function(){this.hasFinished||(this.hasFinished=!0,this.options.after.call(this),this.slideshow.transitionEnd(),this.slideshow.slidesContainer.style.removeProperty("display"),this.slideshow.effectsContainer.style.removeProperty("overflow"),this.slideshow.effectsContainer.style.removeProperty("perspective"),this.slideshow.effectsContainer.style.removeProperty("perspective-origin"),this.slideshow.effectsContainer.style.removeProperty("transform-style"),this.slideshow.effectsContainer.innerHTML="")},random:function(){return arguments[Math.floor(Math.random()*arguments.length)]},createTiles:function(t,e){var i=Math.floor(this.width/t),s=this.width-t*i,n=Math.ceil(s/t);"auto"==e&&(e=Math.round(this.height/i));for(var o=Math.floor(this.height/e),r=this.height-e*o,h=Math.ceil(r/e),d=0,a=document.createDocumentFragment(),l=0;l<t;l++){var p=i,u=r,c=0;if(0<s)p+=f=n<s?n:s,s-=f;for(var m=0;m<e;m++){var f,g=o;if(0<u)g+=f=h<u?h:u,u-=f;var y=document.createElement("div");y.style.setProperty("position","absolute"),y.style.setProperty("width",p+"px"),y.style.setProperty("height",g+"px"),y.style.setProperty("left",d+"px"),y.style.setProperty("top",c+"px"),this.options.createTile.call(this,y,l,m,p,g,d,c),a.appendChild(y),c+=g}d+=p}return a}},dmx.slideshow.transitions.default=function(t,e){return new dmx.slideshow.Transition(t,Object.assign({duration:400,setup:function(){this.slideshow.slider.style.setProperty("transition","left "+this.options.duration+"ms ease-out")},execute:function(){this.slideshow.slider.style.setProperty("left","-"+100*this.index+"%"),setTimeout(this.finished.bind(this),this.options.duration)}},e))},dmx.Component("slideshow",{initialData:{running:!1,index:0},tag:"div",attributes:{slides:{type:Array,default:[]},"slide-url":{type:String,default:"url"},"slide-title":{type:String,default:"title"},"slide-description":{type:String,default:"description"},"slide-link":{type:String,default:"link"},transitions:{type:Object,default:{default:{}}},delay:{type:Number,default:4e3},"show-nav":{type:Boolean,default:!1},"show-paging":{type:Boolean,default:!1},"pause-on-hover":{type:Boolean,default:!1},"start-random":{type:Boolean,default:!1},"no-autostart":{type:Boolean,default:!1}},methods:{start:function(){this.start()},stop:function(){this.stop()},prev:function(t,e){this.prev(t,e)},next:function(t,e){this.next(t,e)},show:function(t,e,i){this.show(t,!1,e,i)}},render:function(t){this.moveListener=this.touchMove.bind(this),this.endListener=this.touchEnd.bind(this),this.$node=document.createElement("div"),this.$node.className=t.className,this.$node.classList.add("dmx-slideshow","dmx-slideshow-loading"),this.$node.id=this.name,this.$node.style.width=t.style.width,this.$node.style.height=t.style.height,t.parentNode.replaceChild(this.$node,t),this.slidesContainer=document.createElement("div"),this.slidesContainer.classList.add("dmx-slideshow-slides-container"),this.slider=document.createElement("div"),this.slider.className="dmx-slideshow-slider",this.slider.style.setProperty("position","relative"),this.effectsContainer=document.createElement("div"),this.effectsContainer.classList.add("dmx-slideshow-effects-container"),this.textboxContainer=document.createElement("div"),this.textboxContainer.classList.add("dmx-slideshow-textbox-container"),this.navContainer=document.createElement("div"),this.navContainer.classList.add("dmx-slideshow-nav-container"),this.pagingContainer=document.createElement("div"),this.pagingContainer.classList.add("dmx-slideshow-paging-container"),this.textboxElm=document.createElement("div"),this.textboxElm.classList.add("dmx-slideshow-textbox"),this.titleElm=document.createElement("div"),this.titleElm.classList.add("dmx-slideshow-title"),this.descriptionElm=document.createElement("div"),this.descriptionElm.classList.add("dmx-slideshow-description"),this.prevElm=document.createElement("div"),this.prevElm.classList.add("dmx-slideshow-prev"),this.nextElm=document.createElement("div"),this.nextElm.classList.add("dmx-slideshow-next"),this.pagesElm=document.createElement("ul"),this.textboxElm.appendChild(this.titleElm),this.textboxElm.appendChild(this.descriptionElm),this.textboxContainer.appendChild(this.textboxElm),this.navContainer.appendChild(this.prevElm),this.navContainer.appendChild(this.nextElm),this.pagingContainer.appendChild(this.pagesElm),this.slidesContainer.appendChild(this.slider),this.$node.appendChild(this.slidesContainer),this.$node.appendChild(this.effectsContainer),this.$node.appendChild(this.textboxContainer),this.$node.appendChild(this.navContainer),this.$node.appendChild(this.pagingContainer),this.props["pause-on-hover"]&&(this.$node.addEventListener("mouseenter",this.pause.bind(this)),this.$node.addEventListener("mouseleave",this.continue.bind(this))),this.$node.addEventListener("mousedown",this.touchStart.bind(this)),this.$node.addEventListener("touchstart",this.touchStart.bind(this));var e=this;if(this.prevElm.addEventListener("mousedown",function(t){t.stopPropagation()}),this.prevElm.addEventListener("touchstart",function(t){t.stopPropagation()}),this.prevElm.addEventListener("click",function(t){t.stopPropagation(),e.prev()}),this.nextElm.addEventListener("mousedown",function(t){t.stopPropagation()}),this.nextElm.addEventListener("touchstart",function(t){t.stopPropagation()}),this.nextElm.addEventListener("click",function(t){t.stopPropagation(),e.next()}),this.slides=[],t.hasChildNodes())for(var i=0;i<t.childNodes.length;i++){var s=t.childNodes[i],n={};this.parseAttribute(s,"transition").forEach(function(t,e){dmx.slideshow.transitions[t.argument]&&(n[t.argument]=t.modifiers)},this),"DMX-SLIDE"==s.tagName&&this.props.slides.push({url:s.getAttribute("url"),title:s.getAttribute("title"),description:s.getAttribute("description"),link:s.getAttribute("link"),transitions:n})}var o=!1;this.parseAttribute(t,"transition").forEach(function(t,e){"all"==t.argument&&Object.keys(dmx.slideshow.transitions).forEach(function(t){this.props.transitions[t]={}},this),dmx.slideshow.transitions[t.argument]&&(o||(delete this.props.transitions.default,o=!0),this.props.transitions[t.argument]=t.modifiers)},this),this.update({})},update:function(t){this.props["show-nav"]!=t["show-nav"]&&(this.props["show-nav"]?this.navContainer.style.removeProperty("display"):this.navContainer.style.setProperty("display","none")),this.props["show-paging"]!=t["show-paging"]&&(this.props["show-paging"]?this.pagingContainer.style.removeProperty("display"):this.pagingContainer.style.setProperty("display","none")),JSON.stringify(this.props.slides)!=JSON.stringify(t.slides)&&(this.stop(),this.slider.innerHTML="",this.effectsContainer.innerHTML="",this.titleElm.innerHTML="",this.descriptionElm.innerHTML="",this.pagesElm.innerHTML="",this.slides=this.props.slides.map(function(t){var e=new dmx.DataScope(t,this),i={loaded:!1,url:dmx.parse(this.props["slide-url"],e),width:0,height:0,title:dmx.parse(this.props["slide-title"],e),description:dmx.parse(this.props["slide-description"],e),link:dmx.parse(this.props["slide-link"],e),transitions:t.transitions||{}},s=this,n=new Image;return n.onload=function(){i.loaded=!0,i.width=this.width,i.height=this.height,dmx.nextTick(function(){this.slides.filter(function(t){return!t.loaded}).length||this.setup()},s)},n.src=i.url,i},this))},setup:function(){var o=0;this.slider.innerHTML="",this.effectsContainer.innerHTML="",this.titleElm.innerHTML="",this.descriptionElm.innerHTML="",this.pagesElm.innerHTML="",this.$node.classList.remove("dmx-slideshow-loading"),this.slides.length&&(this.$node.style.height||this.$node.style.setProperty("padding-top",100*this.slides[0].height/this.slides[0].width+"%"),this.props["start-random"]&&(o=Math.floor(Math.random()*this.slides.length)),this.showText(o),this.showImage(o),this.pagesElm.innerHTML="",this.slides.forEach(function(t,e){var i=this,s=document.createElement("li");s.addEventListener("mousedown",function(t){t.stopPropagation()}),s.addEventListener("touchstart",function(t){t.stopPropagation()}),s.addEventListener("click",function(t){t.stopPropagation(),i.show(e)}),o==e&&(s.className="current"),this.pagesElm.appendChild(s);var n=document.createElement("img");n.setAttribute("src",t.url),n.style.setProperty("position","absolute"),n.style.setProperty("width","100%"),n.style.setProperty("left",100*e+"%"),this.slider.appendChild(n)},this)),this.set("index",o),this.props["no-autostart"]||this.start()},touchStart:function(t){this.animating||t.targetTouches&&1<t.targetTouches.length||(this.moved=!1,this.moveStart={pointer:t.targetTouches?t.targetTouches[0].pageX:t.pageX,slider:this.slider.offsetLeft,last:this.slider.offsetLeft},document.removeEventListener("mousemove",this.moveListener),window.removeEventListener("mouseup",this.endListener),this.$node.removeEventListener("touchmove",this.moveListener),this.$node.removeEventListener("touchend",this.endListener),"touchstart"==t.type?(this.$node.addEventListener("touchmove",this.moveListener),this.$node.addEventListener("touchend",this.endListener)):(document.addEventListener("mousemove",this.moveListener),window.addEventListener("mouseup",this.endListener)))},touchMove:function(t){if(!(t.targetTouches&&1<t.targetTouches.length)){var e=(t.targetTouches?t.targetTouches[0].pageX:t.pageX)-this.moveStart.pointer,i=this.moveStart.slider+e;10<Math.abs(e)&&i<0&&i>-(this.slides.length-1)*this.$node.offsetWidth&&(this.slider.style.setProperty("left",i+"px"),this.moved||(this.hideText(),this.moved=!0))}},touchEnd:function(t){if(this.moved){var e=this.moveStart.last<this.slider.offsetLeft?"ceil":"floor",i=Math.abs(Math[e](this.slider.offsetLeft/this.$node.offsetWidth));this.show(i,!0)}else{var s=this.slides[this.data.index];s.link&&(document.location=s.link)}document.removeEventListener("mousemove",this.moveListener),window.removeEventListener("mouseup",this.endListener),this.$node.removeEventListener("touchmove",this.moveListener),this.$node.removeEventListener("touchend",this.endListener)},pause:function(){this.paused=!0,clearTimeout(this.timer)},continue:function(){this.paused=!1,this.data.running&&this.start()},start:function(){clearTimeout(this.timer),this.timer=setTimeout(this.show.bind(this,this.data.index+1),this.props.delay),this.set("running",!0)},stop:function(){clearTimeout(this.timer),this.set("running",!1)},prev:function(t,e){this.show(this.data.index-1,!1,t,e)},next:function(t,e){this.show(this.data.index+1,!1,t,e)},show:function(t,e,i,s){if(!this.animating){null==t&&(t=this.data.index+1),t>=this.slides.length&&(t=0),t<0&&(t=this.slides.length-1),e?(this.animating=!0,dmx.slideshow.transitions.default(this).run(t)):this.transition(t,i,s),this.hideText(),this.set("index",t);for(var n=0;n<this.pagesElm.childNodes.length;n++)this.pagesElm.childNodes[n].className=t==n?"current":""}},showText:function(t){this.titleElm.innerHTML=this.slides[t].title||"",this.descriptionElm.innerHTML=this.slides[t].description||"",(this.slides[t].title||this.slides[t].description)&&this.textboxElm.classList.add("dmx-slideshow-textbox-show")},hideText:function(){this.textboxElm.classList.remove("dmx-slideshow-textbox-show")},showImage:function(t){this.slider.style.setProperty("left","-"+100*t+"%")},transition:function(t,e,i){if(!e){var s=this.slides[t].transitions,n=Object.keys(s);n.length||(s=this.props.transitions,n=Object.keys(s)),i=s[e=n[Math.floor(Math.random()*n.length)]]}this.animating=!0,dmx.slideshow.transitions[e](this,i).run(t)},transitionEnd:function(){this.animating=!1,this.showImage(this.data.index),this.showText(this.data.index),this.slider.style.removeProperty("transition"),this.data.running&&!this.paused&&this.start()},parseAttribute:function(t,e){var i=[],s=new RegExp("^"+e,"i");if(1==t.nodeType)for(var n=0;n<t.attributes.length;n++){var o=t.attributes[n];if(o&&o.specified&&s.test(o.name)){var r=o.name,h=null,d={};r.split(".").forEach(function(t,e){if(0===e)r=t;else{var i=t.indexOf(":");0<i?d[t.substr(0,i)]=t.substr(i+1):d[t]=!0}});var a=r.indexOf(":");0<a&&(h=r.substr(a+1),r=r.substr(0,a)),i.push({name:r,fullName:o.name,value:o.value,argument:h,modifiers:d})}}return i}}),dmx.slideshow.transitions.fade=function(t,e){return new dmx.slideshow.Transition(t,Object.assign({duration:800,setup:function(){this.slide1=document.createElement("div"),this.slide1.style.setProperty("position","absolute"),this.slide1.style.setProperty("width","100%"),this.slide1.style.setProperty("height","100%"),this.slide1.style.setProperty("background-size",this.width+"px"),this.slide1.style.setProperty("background-image",'url("'+this.prevSlide.url+'")'),this.slide2=document.createElement("div"),this.slide2.style.setProperty("position","absolute"),this.slide2.style.setProperty("width","100%"),this.slide2.style.setProperty("height","100%"),this.slide2.style.setProperty("opacity",0),this.slide2.style.setProperty("transition","opacity "+this.options.duration+"ms ease-in"),this.slide2.style.setProperty("background-size",this.width+"px"),this.slide2.style.setProperty("background-image",'url("'+this.nextSlide.url+'")'),t.effectsContainer.appendChild(this.slide1),t.effectsContainer.appendChild(this.slide2)},execute:function(){this.slide2.addEventListener("transitionend",this.finished.bind(this)),this.slide2.style.setProperty("opacity",1),setTimeout(this.finished.bind(this),this.options.duration)},after:function(){}},e))},dmx.slideshow.transitions.slide=function(t,e){return new dmx.slideshow.Transition(t,Object.assign({direction:"random",duration:600,setup:function(){switch(this.slider=document.createElement("div"),this.slider.style.setProperty("position","absolute"),this.slider.style.setProperty("width","100%"),this.slider.style.setProperty("height","100%"),this.slider.style.setProperty("transition","transform "+this.options.duration+"ms ease-in"),this.image1=document.createElement("div"),this.image1.style.setProperty("position","absolute"),this.image1.style.setProperty("width","100%"),this.image1.style.setProperty("height","100%"),this.image2=this.image1.cloneNode(),this.image1.style.setProperty("background-size",this.width+"px"),this.image1.style.setProperty("background-image",'url("'+this.prevSlide.url+'")'),this.image2.style.setProperty("background-size",this.width+"px"),this.image2.style.setProperty("background-image",'url("'+this.nextSlide.url+'")'),"random"===this.options.direction&&(this.options.direction=["left","right","up","down"][Math.floor(4*Math.random())]),this.options.direction){case"left":this.image2.style.setProperty("left","100%");break;case"right":this.image2.style.setProperty("left","-100%");break;case"up":this.image2.style.setProperty("top","100%");break;case"down":this.image2.style.setProperty("top","-100%")}this.slider.appendChild(this.image1),this.slider.appendChild(this.image2),t.effectsContainer.style.setProperty("overflow","hidden"),t.effectsContainer.appendChild(this.slider)},execute:function(){switch(this.slider.addEventListener("transitionend",this.finished.bind(this)),this.options.direction){case"left":this.slider.style.setProperty("transform","translate(-100%, 0)");break;case"right":this.slider.style.setProperty("transform","translate(100%, 0)");break;case"up":this.slider.style.setProperty("transform","translate(0, -100%)");break;case"down":this.slider.style.setProperty("transform","translate(0, 100%)")}setTimeout(this.finished.bind(this),this.options.duration)},after:function(){t.effectsContainer.style.removeProperty("overflow")}},e))};
//# sourceMappingURL=../maps/dmxSlideshow.js.map
